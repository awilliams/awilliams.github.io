<!doctype html><html><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link rel="shortcut icon" href=https://awilliams.github.io/favicon.ico><link rel=stylesheet href=/css/style.min.css><title>RTanque getting started</title></head><body><header id=banner><h2><a href=https://awilliams.github.io/>awilliams:dev</a></h2><nav><ul></ul></nav></header><main id=content><article><header id=post-header><h1>RTanque getting started</h1><div><time>April 19, 2014</time><br>Updated <time>April 22, 2021</time></div></header><p><img src=/images/rtanque.png alt=RTanque title=RTanque></p><p>This is an introduction to <a href=https://github.com/awilliams/RTanque>RTanque</a>. It covers installation of RTanque and the creation and distribution of a tank. Total time required: <strong>~20min</strong></p><blockquote><p>RTanque is a game for (Ruby) programmers. Players program the brain of a tank and then send their tank+brain into battle against other tanks.</p></blockquote><p>If you are comfortable installing a Ruby gem, run <code>gem install rtanque</code>, and skip to the <a href=#making-a-tank>Making a Tank</a> section.</p><p>Some familiarity with the command line and Ruby would be helpful. All the following commands are run on the command line. OSX or Linux will work great. Sorry Windows users, I have not tried this on your OS.</p><h3 id=prerequisites>Prerequisites</h3><p>Before getting started, make sure you have the following installed. Links to installation guides are provided if not.</p><p><strong>Git</strong> - required to download the RTanque code. Make sure <code>git --version</code> outputs something similar to the following:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>$ git --version
git version 1.8.3.4 <span style=color:#f92672>(</span>Apple Git-47<span style=color:#f92672>)</span>
</code></pre></div><p><a href=http://git-scm.com/downloads>Git installation</a></p><p><strong>Ruby</strong> - language we&rsquo;ll be using. Must use version 1.9 - 2.0 (2.1 is not yet supported). Make sure <code>ruby -v</code> outputs something similar to the following:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>$ ruby -v
ruby 2.0.0p353 <span style=color:#f92672>(</span>2013-11-22 revision 43784<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>x86_64-darwin13.0.2<span style=color:#f92672>]</span>
</code></pre></div><p><a href=https://www.ruby-lang.org/en/installation>Ruby installation</a></p><p><strong>Bundler</strong> - ruby package manager. Should be installed already with ruby, but just in case check the output of <code>bundle -v</code></p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>$ bundle -v
Bundler version 1.3.5
</code></pre></div><p><a href=http://bundler.io/#getting-started>Bundler installation</a></p><h3 id=install>Install</h3><p>Clone the RTanque repository, install the dependencies, and play a quick match.</p><p>We&rsquo;ll make a copy of the RTanque repository. This step could also be done by installing the <a href=http://rubygems.org/gems/rtanque><code>rtanque</code></a> gem directly, but this way you can easily inspect the code and maybe even make some <a href=https://github.com/awilliams/RTanque/pulls>improvements</a> to it.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>$ git clone https://github.com/awilliams/RTanque.git
Cloning into <span style=color:#e6db74>&#39;RTanque&#39;</span>...
...
</code></pre></div><p>Enter into the newly created directory, and install the dependencies.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>$ cd RTanque
$ bundle install
Fetching gem metadata from https://rubygems.org/.........
...
</code></pre></div><p>If <code>bundle install</code> did not work, you probably need to install some dependencies for <strong>Gosu</strong>, the graphics library. See <a href=https://github.com/jlnr/gosu/wiki/Getting-Started-on-Linux>this page</a> for more help.</p><p>Play a quick match to make sure everything works. After running this command, you should see a new window open with 2 tanks. Control the <code>Keyboard</code> tank with <code>a</code>, <code>s</code>, <code>d</code>, <code>w</code> and the arrow keys.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>$ bundle exec bin/rtanque start sample_bots/keyboard.rb sample_bots/seek_and_destroy.rb
</code></pre></div><p>Once you&rsquo;ve won a match or two, continue on&mldr;</p><h2 id=making-a-tank>Making a Tank</h2><p><img src=/images/rtanque_gameover_tank.png alt="GameOver tank" title="GameOver tank"></p><h3 id=setup>Setup</h3><p>The <code>Keyboard</code> tank is fun, but let&rsquo;s make a tank that can drive itself.</p><p><strong>Create a new tank</strong>. The RTanque command line interface will make a basic tank for you. Here we&rsquo;ll name the tank <code>GameOver</code>, but you can name yours whatever you like. Use CamelCaseNaming. Make sure to adjust the following commands for the name you choose.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>$ bundle exec bin/rtanque new_bot GameOver
      create  bots/game_over.rb
</code></pre></div><p>Open the newly created file for editing using your editor of choice in the <code>bots</code> directory. You should see something like the following:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>GameOver</span> <span style=color:#f92672>&lt;</span> <span style=color:#66d9ef>RTanque</span><span style=color:#f92672>::</span><span style=color:#66d9ef>Bot</span><span style=color:#f92672>::</span><span style=color:#66d9ef>Brain</span>
  <span style=color:#66d9ef>NAME</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;GameOver&#39;</span>
  <span style=color:#66d9ef>include</span> <span style=color:#66d9ef>RTanque</span><span style=color:#f92672>::</span><span style=color:#66d9ef>Bot</span><span style=color:#f92672>::</span><span style=color:#66d9ef>BrainHelper</span>

  <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>tick!</span>
    <span style=color:#75715e>## main logic goes here</span>

    <span style=color:#75715e># use self.sensors to detect things</span>
    <span style=color:#75715e># See http://rubydoc.info/github/awilliams/RTanque/master/RTanque/Bot/Sensors</span>

    <span style=color:#75715e># use self.command to control tank</span>
    <span style=color:#75715e># See http://rubydoc.info/github/awilliams/RTanque/master/RTanque/Bot/Command</span>

    <span style=color:#75715e># self.arena contains the dimensions of the arena</span>
    <span style=color:#75715e># See http://rubydoc.info/github/awilliams/RTanque/master/frames/RTanque/Arena</span>
  <span style=color:#66d9ef>end</span>
<span style=color:#66d9ef>end</span>
</code></pre></div><p>Make sure that it is in fact a working tank.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>$ bundle exec bin/rtanque start sample_bots/keyboard.rb bots/game_over.rb
</code></pre></div><p>Hopefully you saw a new RTanque window open, and your lifeless tank just sitting there.</p><p>Time to give your tank some intelligence.</p><h3 id=basics>Basics</h3><p><a href=http://rubydoc.info/github/awilliams/RTanque/master/RTanque/Bot/Brain><strong>RTanque::Bot::Brain</strong></a> -
This is where you&rsquo;ll spend most of your time, as your tank is an instance of this class. RTanque uses a loop to update the state of the game. Every iteration of this loop calls the <code>tick!#</code> method on your Brain instance.
This is your chance to react to any changes in the game since the last tick, by reading from the sensors and giving commands. This method is called many times per second.</p><p>There are two primary methods <code>#commands</code> and <code>#sensors</code> to control the tank and get information about your tank, respectively. We&rsquo;ll go into more detail about these methods below.</p><p><a href=http://rubydoc.info/github/awilliams/RTanque/master/RTanque/Heading><strong>RTanque::Heading</strong></a> -
Angles are represented by instances of the this class. For example, to turn the tank, you pass an instance of <code>RTanque::Heading</code> to <code>Command#heading=</code>.
Review the documentation for that class to familiarize yourself with it, as it&rsquo;s used throughout the project.</p><p>Examples:</p><p><code>RTanque::Heading.new(RTanque::Heading::NORTH)</code> is a heading pointing up, and <code>RTanque::Heading.new(RTanque::Heading::EAST)</code> to the right. Headings are always absolute, never relative to the tank or any other object.</p><p><a href=http://rubydoc.info/github/awilliams/RTanque/master/RTanque/Point><strong>RTanque::Point</strong></a> -
Locations of objects, such as tanks, are described with instances of this class. The upper-left corner is (0,0).</p><h3 id=movement>Movement</h3><p>Now we have to code a bit of Ruby to get your tank moving.</p><p>Have a look at the <a href=http://rubydoc.info/github/awilliams/RTanque/master/RTanque/Bot/Command>RTanque::Bot::Command</a> class.
Each tick, you are provided with a new instance of <code>Command</code> via <code>Brain#command</code>.</p><p>There are limits to how you can control your tank. There&rsquo;s a speed limit, rotation limit, etc. Don&rsquo;t worry too much about that now, because if you provide a speed over the limit, for example, it will automatically be corrected to the maximum allowed.
See <a href=http://rubydoc.info/github/awilliams/RTanque/master/RTanque/Bot/BrainHelper>RTanque::Bot::BrainHelper</a> for some useful constants when setting command values.</p><p>There are three main aspects of your tank to control:</p><p><strong>Body</strong>. The main part of the tank which everything else is attached to. The body can move forward and backward at a variable speed, and also can turn at a variable speed. The two methods
to use are <code>Command#speed=</code> and <code>Command#heading=</code>. Pass a negative speed to move backwards.</p><p>There limits to the values you can pass to each of these methods. If you pass a larger value than is allowed, it will be reduced to the maximum allowed.</p><p><strong>Radar</strong>. The radar can rotate independently of the body. It&rsquo;s purpose is to detect other tanks. The radar has a limited field of vision so you can only detect other tanks that your radar is generally pointed at.
Use the method <code>Command#radar_heading=</code>, passing an instance of <code>Heading</code>, to rotate the radar.</p><p><strong>Turret</strong>. The turret/gun can fire shells and can also rotate independently. Rotate the turret with <code>Command#turret_heading=</code> and fire the gun with <code>Command#fire</code>.
Send a large value to <code>#fire</code> to fire a fast shell, and a smaller value to fire a slower shell.</p><p>Slower shells do less damage, but can be fired in rapid succession. Fast shells do more damage, but require more time between shots for the turret to recover.</p><p><strong>Example</strong>. Enough explaining! To get a better idea of how all this comes together to control your tank, make some changes to your code.
Provided below are some sample changes, but you&rsquo;re encouraged to experiment with variations to better understand how to control the tank.</p><p>Change the <code>#tick!</code> method of your tank to something similar to the following:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>tick!</span>
  <span style=color:#75715e># head right</span>
  command<span style=color:#f92672>.</span>heading <span style=color:#f92672>=</span> <span style=color:#66d9ef>RTanque</span><span style=color:#f92672>::</span><span style=color:#66d9ef>Heading</span><span style=color:#f92672>.</span>new(<span style=color:#66d9ef>RTanque</span><span style=color:#f92672>::</span><span style=color:#66d9ef>Heading</span><span style=color:#f92672>::</span><span style=color:#66d9ef>EAST</span>)
  <span style=color:#75715e># full speed ahead</span>
  command<span style=color:#f92672>.</span>speed <span style=color:#f92672>=</span> <span style=color:#66d9ef>MAX_BOT_SPEED</span>
  <span style=color:#75715e># while looking behind us</span>
  command<span style=color:#f92672>.</span>radar_heading <span style=color:#f92672>=</span> <span style=color:#66d9ef>RTanque</span><span style=color:#f92672>::</span><span style=color:#66d9ef>Heading</span><span style=color:#f92672>.</span>new(<span style=color:#66d9ef>RTanque</span><span style=color:#f92672>::</span><span style=color:#66d9ef>Heading</span><span style=color:#f92672>::</span><span style=color:#66d9ef>WEST</span>)
  <span style=color:#75715e># and aiming down</span>
  command<span style=color:#f92672>.</span>turret_heading <span style=color:#f92672>=</span> <span style=color:#66d9ef>RTanque</span><span style=color:#f92672>::</span><span style=color:#66d9ef>Heading</span><span style=color:#f92672>.</span>new(<span style=color:#66d9ef>RTanque</span><span style=color:#f92672>::</span><span style=color:#66d9ef>Heading</span><span style=color:#f92672>::</span><span style=color:#66d9ef>SOUTH</span>)
  <span style=color:#75715e># and firing some slow &amp; rapid shells</span>
  command<span style=color:#f92672>.</span>fire(<span style=color:#66d9ef>MIN_FIRE_POWER</span>)
<span style=color:#66d9ef>end</span>
</code></pre></div><p>After making changes, start a new match. Depending on where your bot starts, you&rsquo;ll see it spin around the move to the right border while firing.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>bundle exec bin/rtanque start sample_bots/keyboard.rb bots/game_over.rb
</code></pre></div><p>By this point, you can hopefully drive your tank as you would like, but you will be driving blind so to speak. You need help from the tank&rsquo;s sensors to figure out how to better react.</p><h3 id=input>Input</h3><p>Have a look at the <a href=http://rubydoc.info/github/awilliams/RTanque/master/RTanque/Bot/Sensors>RTanque::Bot::Sensors</a>.
Each tick, you are provided with a new instance of <code>Sensors</code> via <code>Brain#sensors</code>.</p><p>There are many things we can detect about the game state via the <code>Sensors</code> instance. Most are self-explanatory.</p><p><strong>Health</strong>. If your health falls below 0, your tank blows up and is removed from the game. It could be helpful to monitor this value and modify your strategy if you are low on health.</p><p><strong>Gun Energy</strong>. If this value is below zero, you cannot fire shells. If you fire fast shells, your gun energy depletes more quickly than slower shells.</p><p><strong>Radar</strong>. It is useful to detect the position of other tanks. <code>#radar</code> can be treated like an array of <a href=http://rubydoc.info/github/awilliams/RTanque/master/RTanque/Bot/Radar/Reflection><code>Radar::Reflection</code></a> instances.
A reflection contains the name, distance, and heading of the detected tank.
Depending on the heading of your radar, you will be able to detect some or no tanks.</p><p><strong>Example</strong>. Like before, we will modify the <code>#tick!</code> method of your tank to try out some sensing methods.</p><p>Change the <code>#tick!</code> method of your tank to something to the following:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>tick!</span>
  <span style=color:#75715e># head right</span>
  command<span style=color:#f92672>.</span>heading <span style=color:#f92672>=</span> <span style=color:#66d9ef>RTanque</span><span style=color:#f92672>::</span><span style=color:#66d9ef>Heading</span><span style=color:#f92672>.</span>new(<span style=color:#66d9ef>RTanque</span><span style=color:#f92672>::</span><span style=color:#66d9ef>Heading</span><span style=color:#f92672>::</span><span style=color:#66d9ef>EAST</span>)
  <span style=color:#75715e># full speed ahead</span>
  command<span style=color:#f92672>.</span>speed <span style=color:#f92672>=</span> <span style=color:#66d9ef>MAX_BOT_SPEED</span>
  <span style=color:#75715e># while looking behind us</span>
  command<span style=color:#f92672>.</span>radar_heading <span style=color:#f92672>=</span> <span style=color:#66d9ef>RTanque</span><span style=color:#f92672>::</span><span style=color:#66d9ef>Heading</span><span style=color:#f92672>.</span>new(<span style=color:#66d9ef>RTanque</span><span style=color:#f92672>::</span><span style=color:#66d9ef>Heading</span><span style=color:#f92672>::</span><span style=color:#66d9ef>WEST</span>)
  <span style=color:#75715e># and aiming down</span>
  command<span style=color:#f92672>.</span>turret_heading <span style=color:#f92672>=</span> <span style=color:#66d9ef>RTanque</span><span style=color:#f92672>::</span><span style=color:#66d9ef>Heading</span><span style=color:#f92672>.</span>new(<span style=color:#66d9ef>RTanque</span><span style=color:#f92672>::</span><span style=color:#66d9ef>Heading</span><span style=color:#f92672>::</span><span style=color:#66d9ef>SOUTH</span>)
  <span style=color:#75715e># and firing some slow &amp; rapid shells</span>
  command<span style=color:#f92672>.</span>fire(<span style=color:#66d9ef>MIN_FIRE_POWER</span>)

  <span style=color:#75715e># every 100 ticks, log sensor info</span>
  at_tick_interval(<span style=color:#ae81ff>100</span>) <span style=color:#66d9ef>do</span>
    puts <span style=color:#e6db74>&#34;Tick #</span><span style=color:#e6db74>#{</span>sensors<span style=color:#f92672>.</span>ticks<span style=color:#e6db74>}</span><span style=color:#e6db74>!&#34;</span>
    puts <span style=color:#e6db74>&#34; Gun Energy: </span><span style=color:#e6db74>#{</span>sensors<span style=color:#f92672>.</span>gun_energy<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>
    puts <span style=color:#e6db74>&#34; Health: </span><span style=color:#e6db74>#{</span>sensors<span style=color:#f92672>.</span>health<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>
    puts <span style=color:#e6db74>&#34; Position: (</span><span style=color:#e6db74>#{</span>sensors<span style=color:#f92672>.</span>position<span style=color:#f92672>.</span>x<span style=color:#e6db74>}</span><span style=color:#e6db74>, </span><span style=color:#e6db74>#{</span>sensors<span style=color:#f92672>.</span>position<span style=color:#f92672>.</span>y<span style=color:#e6db74>}</span><span style=color:#e6db74>)&#34;</span>
    puts sensors<span style=color:#f92672>.</span>position<span style=color:#f92672>.</span>on_wall? ? <span style=color:#e6db74>&#34; On Wall&#34;</span> : <span style=color:#e6db74>&#34; Not on wall&#34;</span>
    puts <span style=color:#e6db74>&#34; Speed: </span><span style=color:#e6db74>#{</span>sensors<span style=color:#f92672>.</span>speed<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>
    puts <span style=color:#e6db74>&#34; Heading: </span><span style=color:#e6db74>#{</span>sensors<span style=color:#f92672>.</span>heading<span style=color:#f92672>.</span>inspect<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>
    puts <span style=color:#e6db74>&#34; Turret Heading: </span><span style=color:#e6db74>#{</span>sensors<span style=color:#f92672>.</span>turret_heading<span style=color:#f92672>.</span>inspect<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>
    puts <span style=color:#e6db74>&#34; Radar Heading: </span><span style=color:#e6db74>#{</span>sensors<span style=color:#f92672>.</span>radar_heading<span style=color:#f92672>.</span>inspect<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>
    puts <span style=color:#e6db74>&#34; Radar Reflections (</span><span style=color:#e6db74>#{</span>sensors<span style=color:#f92672>.</span>radar<span style=color:#f92672>.</span>count<span style=color:#e6db74>}</span><span style=color:#e6db74>):&#34;</span>
    sensors<span style=color:#f92672>.</span>radar<span style=color:#f92672>.</span>each <span style=color:#66d9ef>do</span> <span style=color:#f92672>|</span>reflection<span style=color:#f92672>|</span>
      puts <span style=color:#e6db74>&#34;  </span><span style=color:#e6db74>#{</span>reflection<span style=color:#f92672>.</span>name<span style=color:#e6db74>}</span><span style=color:#e6db74> </span><span style=color:#e6db74>#{</span>reflection<span style=color:#f92672>.</span>heading<span style=color:#f92672>.</span>inspect<span style=color:#e6db74>}</span><span style=color:#e6db74> </span><span style=color:#e6db74>#{</span>reflection<span style=color:#f92672>.</span>distance<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>
    <span style=color:#66d9ef>end</span>
  <span style=color:#66d9ef>end</span>
<span style=color:#66d9ef>end</span>
</code></pre></div><p>After making changes, start a new match. This time, pay attention to the console where you start the match from. Ever 100 ticks, your tank will log
its sensor state. Try moving the <code>Keyboard</code> tank in and out of your tank&rsquo;s radar view.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>bundle exec bin/rtanque start sample_bots/keyboard.rb bots/game_over.rb
</code></pre></div><h3 id=summary>Summary</h3><p>We have seen how to control a tank and also how to analyze the game state. Now it is time to add some logic to help your tank better defend itself and maybe even win a match.
Take a look at the <a href=https://github.com/awilliams/RTanque/blob/master/sample_bots/seek_and_destroy.rb>SeekAndDestroy</a> tank, which is included in the repository, for an example of a complete working tank.</p><p><strong>Distribution</strong></p><p>At some point, you may want to share your tank with others, or maybe download a friend&rsquo;s tank.</p><p>The first step to distributing your tank is to upload your tank <a href=https://gist.github.com/>as a Gist</a> (either public or secret). After creating your gist, it will be assigned an id. With this id, others can download your tank.</p><p>Here&rsquo;s the <a href=https://gist.github.com/SteveRidout/5909793>Marksman</a> tank. You&rsquo;ll notice it has id 5909793. To download this tank and start a match with it:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>$ bundle exec bin/rtanque get_gist <span style=color:#ae81ff>5909793</span>
      create  bots/SteveRidout.5909793/Marksman.rb
$ bundle exec bin/rtanque start sample_bots/keyboard.rb bots/game_over.rb bots/SteveRidout.5909793/Marksman.rb
</code></pre></div><p>(Good luck beating <code>Marksman</code> with the <code>Keyboard</code>)</p><hr><p>I hope you have found this guide useful. If you find something lacking, or even if you&rsquo;d like to leave a comment, <a href=https://github.com/awilliams/awilliams.github.io/blob/master/_posts/2014-01-11-rtanque-getting-started.markdown>open a pull-request</a> or find me on Twitter <a href=https://twitter.com/ACW5>@acw5</a>.</p><p><img src=/images/rtanque_boom.png alt="Game Over" title=Booom></p></article></main><footer id=footer></footer></body></html>